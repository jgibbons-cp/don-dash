sudo: required
services:
- docker
before_install:
- docker build -t $DOCKER_IMAGE .
after_success:
- docker login -e $DOCKER_EMAIL -u $DOCKER_USER -p $DOCKER_PASSWORD
- docker push $DOCKER_IMAGE
script:
- docker run -it --rm $DOCKER_IMAGE py.test
- docker run -it --rm -e HALO_API_KEY=$HALO_API_KEY -e HALO_API_SECRET_KEY=$HALO_API_SECRET_KEY
  -e HALO_API_HOSTNAME=$HALO_API_HOSTNAME -e HALO_API_PORT=$HALO_API_PORT -e HALO_AGENT_KEY=$HALO_AGENT_KEY
  -e SERVER_GROUP=$SERVER_GROUP $DOCKER_IMAGE /app/scan_with_halo.sh
env:
  global:
  - SERVER_GROUP=dondash
  - HALO_API_HOSTNAME=api.cloudpassage.com
  - HALO_API_PORT=443
  - DOCKER_IMAGE="jenksgibbons/don-dash:latest"
  - secure: nJSPmmi4WWBuWA4p1yAd4OB+HHlJheBNO14G5Bmh24cY7+D1/wto0zW25l1th2jtlNHq1AAUuJyG7M9VPmNhi9cz6NdJztc9jd5IHOkiIvUIJY4VkHQBfs7Ec5Zmm0H1xlN1EB8AUWQp5GHt2pYxbZyEc5Y7f8MqEzyVwYNsoxEHjogXh0YsNUFyhDIrnQJOucKMIWFhm24WKjtNCaaSdKiSBQuZyz3/lo1bqZKK98xXxIkAp/c8bsxuX9ZjGtXLEwQE8RrA6ArhzkKKFqnbpNLHWMbfOxWD7/BONusLU0WsKNFHh7fe801pKcuqh5VFgd+pfg0WcU4YijUYkobfMHMuH2mrRKcnyhp4skb7sgN7//qw/3SrE15n49ImD79/R+hfVGr7eOoWh/ii1gT9tERWa+tKHdBNQ7zXHVqiCObaMHG1/GbJ77ephr9ysjX5zI+zUOagkrIDN0C5/VLG8kZbFvTunWOVPUyjrxnD8/3WyZpQwb9AZ1uW1DScybcaMvsM8UvgBywPrjwGw7Tpqp/Qe2g8s3x0naSVBbBMaKvHlBHJ4FIIR0rQ6VbgNN8hPd335l2QUh4M53FB6vvTcJHUCuSOM1yec90qeLrKs87retm9ScY8OvsOsHbhYgSpe/BfdMJ/mHG2qlsIBHkwNpJ6Iy8lRUyrhl5jPWAkpQY=
  - secure: oHAD+ccNK7b/GiV17qAzk3UG6AZ1aU7zPUMP9/sFZES87LdDEfQF6JRYQbVQCNXj6GNowSCtsOvv4ECEEvU2zB0fGfedQzsJu6y0Xwp4KVphAlbsH5cs7s2h1LSxhe1cQBJS4g86hog6ZiJ78+ssTHOmdrCZ7amtAfT9yWfcch8kqEJuYIPI2FWu1Xq+buc6rr+UHzBPia7nZbomP51lMF0SX8XJPov3hSemdUz/+LIJXRsz33ur6FSBaoON404EgQN5MchCj67sFxaiNdqvcknZ9YLnB+wiluNpUJy0fUIe2iwkk8aq3j+2qLC4QvWMo02fMerzgGxGWtJHQ1THTeCgtKmTliWeL/XrYTcbIGpqd7CtHbjQHSMlRLoRrINTobfhCd0WUaM5o3cQPWzVSaJgE+rezX3fhtxn2Q0BlDaL7/tcwYeN6rwGX9nxjpbxptiLEYDy1OK5APftQonZ5WQ19IxP4Roa1EHa+m2aXUkLJs9UMeG6O3Gj5sgjVOFdzhtGfNmpxLKH5l21+DgZcvg8jqAnkNo/Wgwef6wCKURYy4Nxko+WHl9xsv1Qf27nbbkTUUGG9XlSHf2utQn9SMss0xIMeIYoIS6vN8oW0oTbQV7VRqB4hrXNNXRh7CTGCEl33yKBOyEdAB1XvjtQTkaTVswLvEJLcz9IxpbjBGk=
  - secure: OSTlsD3VxWqR8ws4GeLjx2aLLOvb/18ewMsEoU5/cwAnEjEHbTMBt7pFAaVQtIllQg2dB9K4JB2n6oAgpAXF8WPiiqdhqs6UbV8OUm4DYKjr0DltzBfPBH7if8bXjRWGowgs1EtuTFU8CakAh+wVUaX1m3S6ynxTeJQj0jwn0qNzy3HD3NZagrHP4NZlEPyup2RFbepvmNTiZIvTlS0tFMcRymOU9HF9w+oFh9v4/SDRUlIA8vn00eZRTSrF95FbIyumulwn08BcVE6CkEFtOnuJztXPWzIVniumbqpn2i9ZXgW6qWzKFgEN0PP6ji9Frk9k1RPSwmuXS4bWsojrL1lIf0bEBQqJNj1HosbTYbIlrpEMcLp8ZViAPmpxxqyFfrovkivNIk51le68iF/+JQSltcnIajWGBpoCeY9QC7XzR0Q6wkN11gsUwv1t8C+SRkds/yuZM08XCf4ehm4cUyf/YJhAAZ90uP+5mPzT9KAIca++hIA8rwVrhp960mn23k5Ea5/Rl5ZWs4THSeYdteX1/dnwo57CUS4cbCBEcDdASVvwCR/LLzfVKGD07bbS7CzHZD50X0IDsUBi1qbUn2cIGK4EdG5UWnPfi4R60rzhJ4H/7Ft49FMaIiKl21OvybZEKt2EJLyNssApsuTuutnEmL2/QTCHo/9fGmqELho=
  - secure: XN5tImKWYicTvkvVIHbyxSqeCmz0A5KGWbo6cw9oPofqCDu46abY5oekilB6GGc935KlylkzMdx0bdnX2e13eGExkp2Yv1gs8b+rbqJTv6KYaxdGZFx3H/FpCU3puUX0KMiMVbtCwbrIUXQ0yAJGYsgF16S1lHEi1N2Edj2v8DlWvINhHFGVO/FUJ+Kl3plHhEz/0+iDaqHYb1OENyYX9hf480UsfqZM8gWJGkB051s34duULPtXjL1KG5ncFDRY+ByGB7BBLSZf7HJL/J/40CuA3f9cl1Yp42EPZ6Cm2f9tid0qH+Q8qiVBE2A9yadWviJZRVYcG1pFsp5VHHNr7BqK/TERBIIN2Q0eI6fV/+nOKCLgiCnywBH66kDdStvSS549iG/BtcAeDKDdjonJGU10rcfbYrOMzYXYSLZE0OPmTDvSfqh7flXOTEOAoH5OjJj5LS045BoegiK5ASiRNGWQoLVk99I5dZD8uWzGgVey2A8fwkSn0K16b3WygGEECFCn8Ktyy7x4xLqhMXjOVaG0zG8WGaStdHfyQtu9wpGF+h+ImkTkz0wn3s0Tn9EihgBeRnmXHM+pVVR0AGfcNlSYIIgbVSYyC6zQBELiZF5/Pzr2TFyCOH72YQ62anW2HkV6eyzvNt8UXuzLnt7WfwP7mgswO8x0yL9IbL73WO8=
  - secure: goHS2R783XsPI1ydrO1nhOBF4hEefdwJF8ACKtxI30qoULpniwDs23BlM3GBnL3IE1hlt6Ud5XdFoKwQN6OIcll+4hn+W9xnH5dF8EBrfT/IGUqq4KUOoEcKAc72EAOuiTcGIBmZU1mQ7+a+YtcdDOn0yDekpErr4J9JydE3U22ooWF5YzenW60Uyj/XrvyfeFDXlbmcaZpk7+Kz5DhK2ZdL6A7csYzH1P8eI4lpNyE2uAShOlOOyrkX3DDgAaLD2IKcuBKENrfkJeqlN66hy1ExXIAAf63gYsKcpX5a2G0YjK9WgkAjkTb6uW7Mqh/q08y3doPcGF24nnWL5YaZPtQj6g2aImuYk4Kz3UxVr51pdCbIW1Juhbko/SxsrGUc/5QWG6vw5pWjolYGmVmQJ9WmnuEACU2jIGSEcthqFK5IW05AeyXxddJkWpmfSHtfFMAZ0+FHvNqfu/qrtuLod6uQ2erCGWRimvOu6jexg6wrx1RQFyIISbZQ5MCtwcVnPpVgzPWGhJ9280RMmjUSRfkEvw5VblurZfmuvZtbLP0nBwZka40MWZsHSqzLoFI6IsQ0STxWXSDIbow42cFeVLLEWuMNvywSSaS+8dszru2olnwrpG2i2Zb2Mr9vQUcv6hLl4B5gq5wib8DNus8YmEHst9nD3lX9WuXSq5CYSUM=
  - secure: Qmfjjm8ol07hzHIVAV639Aqa0pmo6St4oZBGN5KyYoilG7kaNZV8rHz3yWavFH7WPqHltkQhQ1tLc2sdZ8I3RJ6fWKLiKyoTdptEN1aWrlseKI5/XyLBJ3rR2Z3LJROt+zctrgnSimWd/Dx5WE1NRNIEWp3QJWeQl5MwLHIdXW4hAJnr6IZjad+6K3ojiL8hInJl5+ScYxlhmes92Kpu3slAGcxblHqLA78lW5jYoCKCGfiHoaczbk/53QS4BJE42ix+ITScCUC9Jxeog+MOfi1zUQ0LVr6YaNc+CByk2qqBOlGoD0PZCKwPIB6xqom220rXAmrIARvdk04kMo5/K5lzJdDEPgBapRQy4HysJ9m9oEc2GTLlChgxXpKHknQF9d79S16KjBmHPZCFgBFr8vGNpAZr43vLCZSPSiYg4DyZJGJU6FZJW5fns6fqs3MpmrqmjOJOVouG1TPWbEWmA+Kp+66OxctNZXlSGI3RYFwwEYhbGdyyJ/O2Dc77V3fxrfxCno0Pqi+8rATalwia+Ln9UzAkfvnvSN+srLGrVUPm0eDXWmJmGwdbHj8Cs9olrpLWGKK4XcBe4P8mMOn96oR3CK7c6ysbdCNRP7PKSh4WzimRk9HrAPlvZWE4XsDaSsCdNPiPN/GSi4dwXnsbNNB6d1KpxtLDzDf+naPwZU4=
